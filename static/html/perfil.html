<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Perfil - EmoConnect</title>
    <link rel="stylesheet" href="../css/perfil.css" />
    <script src="../js/perfil.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
  </head>

  <body>
    <!-- ğŸ”’ ProteÃ§Ã£o de Rota - Verificar AutenticaÃ§Ã£o -->
    <script type="module">
      import {
        redirectIfNotAuthenticated,
        getUserName,
        getUserEmail
      } from "../js/auth.js";
      redirectIfNotAuthenticated();

      // Atualizar dados do usuÃ¡rio quando a pÃ¡gina carregar
      window.addEventListener("DOMContentLoaded", () => {
        const profileName = document.getElementById("profile-name");
        if (profileName) {
          profileName.textContent = getUserName();
        }
      });
    </script>

    <header>
      <div class="container">
        <h1>ğŸŒŸ EmoConnect</h1>
        <p id="datetime"></p>
        <nav>
          <ul>
            <li><a href="index.html">InÃ­cio</a></li>
            <li><a href="perfil.html" class="active">Perfil</a></li>
            <li><a href="chat.html">Chat</a></li>
            <li>
              <a href="#" id="logout-btn" style="color: #ff4757">
                <i class="fas fa-sign-out-alt"></i> Sair
              </a>
            </li>
          </ul>
        </nav>
      </div>
      <button id="toggle-theme" class="theme-toggle" title="Alternar tema">
        ğŸŒ™
      </button>
    </header>

    <!-- Script de Logout -->
    <script type="module">
      import { logout } from "../js/auth.js";

      const logoutBtn = document.getElementById("logout-btn");
      if (logoutBtn) {
        logoutBtn.addEventListener("click", async (e) => {
          e.preventDefault();

          const confirmar = confirm("Deseja realmente sair?");
          if (confirmar) {
            await logout();
            window.location.href = "/html/login.html";
          }
        });
      }
    </script>

    <main class="profile-layout">
      <aside class="profile-sidebar">
        <div class="profile-banner">
          <p id="daily-message">"Hoje Ã© um bom dia para cuidar de vocÃª."</p>
        </div>

        <img
          src="user-placeholder.png"
          alt="Foto de perfil"
          class="profile-pic"
          id="profile-img"
        />

        <h2 id="profile-name">Fulano de Tal</h2>
        <p class="bio" id="profile-bio">
          "Aqui para compartilhar emoÃ§Ãµes e experiÃªncias."
        </p>

        <button id="edit-profile-btn">
          <i class="fas fa-edit"></i> Editar Perfil
        </button>
        <button id="toggle-public-view">
          <i class="fas fa-eye"></i> Ver como pÃºblico
        </button>

        <div class="progress-bar">
          <p>VocÃª compartilhou <span id="post-count">0</span> posts ğŸ’¬</p>
          <progress id="post-progress" max="10" value="0"></progress>
        </div>

        <div class="background-selector">
          <label for="background-theme">ğŸ¨ Fundo:</label>
          <select id="background-theme">
            <option value="default">PadrÃ£o</option>
            <option value="sunset">PÃ´r do Sol</option>
            <option value="floral">Floral</option>
            <option value="dark">Escuro</option>
          </select>
        </div>
      </aside>

      <section class="profile-main">
        <div class="tabs">
          <button class="tab active" data-tab="sobre">Sobre Mim</button>
          <button class="tab" data-tab="posts">Posts</button>
          <button class="tab" data-tab="humor">Humor DiÃ¡rio</button>
          <button class="tab" data-tab="galeria">Galeria</button>
          <button class="tab" data-tab="config">ConfiguraÃ§Ãµes</button>
        </div>

        <div id="tab-sobre" class="tab-content active">
          <p><strong>Idade:</strong> <span id="idade">25 anos</span></p>
          <p>
            <strong>LocalizaÃ§Ã£o:</strong>
            <span id="localizacao">SÃ£o Paulo, Brasil</span>
          </p>
          <p>
            <strong>Interesses:</strong>
            <span id="interesses">MÃºsica, Livros, Bem-estar</span>
          </p>
        </div>

        <div id="tab-posts" class="tab-content">
          <form id="post-form">
            <textarea id="new-post" placeholder="Escreva algo..."></textarea>
            <div class="emotion-selector">
              <p>Como vocÃª estÃ¡ se sentindo?</p>
              <div class="emotion-buttons">
                <button type="button" class="emotion-btn" data-emotion="feliz">
                  ğŸ˜Š Feliz
                </button>
                <button type="button" class="emotion-btn" data-emotion="triste">
                  ğŸ˜¢ Triste
                </button>
                <button
                  type="button"
                  class="emotion-btn"
                  data-emotion="ansioso"
                >
                  ğŸ˜° Ansioso
                </button>
                <button type="button" class="emotion-btn" data-emotion="calmo">
                  ğŸ˜Œ Calmo
                </button>
                <button
                  type="button"
                  class="emotion-btn"
                  data-emotion="irritado"
                >
                  ğŸ˜  Irritado
                </button>
              </div>
            </div>
            <button type="submit">
              <i class="fas fa-paper-plane"></i> Publicar
            </button>
          </form>

          <input
            type="text"
            id="search-posts"
            placeholder="ğŸ” Buscar post..."
          />
          <div class="post-list" id="post-list"></div>
        </div>

        <div id="tab-humor" class="tab-content">
          <h3>Registro de Humor DiÃ¡rio</h3>
          <div class="mood-tracker">
            <div class="mood-today">
              <h4>Como vocÃª estÃ¡ se sentindo hoje?</h4>
              <div class="mood-buttons">
                <button class="mood-btn" data-mood="excelente">
                  ğŸ˜ Excelente
                </button>
                <button class="mood-btn" data-mood="bem">ğŸ™‚ Bem</button>
                <button class="mood-btn" data-mood="neutro">ğŸ˜ Neutro</button>
                <button class="mood-btn" data-mood="mal">ğŸ™ Mal</button>
                <button class="mood-btn" data-mood="pessimo">ğŸ˜ PÃ©ssimo</button>
              </div>
              <div class="mood-notes">
                <textarea
                  id="mood-note"
                  placeholder="Anote aqui o que influenciou seu humor hoje..."
                ></textarea>
                <button id="save-mood">Salvar registro</button>
              </div>
            </div>

            <div class="mood-history">
              <h4>HistÃ³rico de Humor</h4>
              <div class="mood-calendar" id="mood-calendar">
                <!-- Gerado dinamicamente pelo JavaScript -->
              </div>
              <div class="mood-chart">
                <h5>Seu Humor na Ãšltima Semana</h5>
                <div class="chart-container" id="mood-chart">
                  <!-- GrÃ¡fico gerado dinamicamente pelo JavaScript -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="tab-galeria" class="tab-content">
          <h3>Galeria de Fotos</h3>
          <div class="photo-upload">
            <button id="add-photo">
              <i class="fas fa-plus"></i> Adicionar Foto
            </button>
            <input
              type="file"
              id="photo-input"
              accept="image/*"
              style="display: none"
              multiple
            />
          </div>
          <div class="gallery-container" id="photo-gallery">
            <!-- Fotos serÃ£o adicionadas pelo JavaScript -->
          </div>
        </div>

        <div id="tab-config" class="tab-content">
          <h3>PreferÃªncias</h3>
          <div class="config-item">
            <label>
              <input type="checkbox" id="notificacoes-check" />
              Receber notificaÃ§Ãµes
            </label>
          </div>
          <div class="config-item">
            <label>
              <input type="checkbox" id="mensagens-privadas-check" checked />
              Permitir mensagens privadas
            </label>
          </div>
          <div class="config-item">
            <label>Idioma:</label>
            <select id="idioma-select">
              <option value="pt-br">PortuguÃªs (Brasil)</option>
              <option value="en">English</option>
              <option value="es">EspaÃ±ol</option>
            </select>
          </div>
          <div class="config-item">
            <label>Visibilidade do perfil:</label>
            <select id="privacidade-select">
              <option value="publico">PÃºblico</option>
              <option value="amigos">Apenas amigos</option>
              <option value="privado">Privado</option>
            </select>
          </div>

          <h3>Conectar emoÃ§Ãµes</h3>
          <div class="config-item">
            <label>
              <input type="checkbox" id="mostrar-humor-check" checked />
              Mostrar meu humor diÃ¡rio no perfil
            </label>
          </div>
          <div class="config-item">
            <label>
              <input type="checkbox" id="lembretes-check" />
              Lembretes para registro de humor
            </label>
          </div>

          <button id="save-config-btn" class="save-btn">
            Salvar preferÃªncias
          </button>
        </div>
      </section>
    </main>

    <div class="modal" id="edit-modal">
      <div class="modal-content">
        <h3>Editar Perfil</h3>
        <label>Nome:</label><input type="text" id="edit-name" />
        <label>Bio:</label><input type="text" id="edit-bio" />
        <label>Idade:</label><input type="text" id="edit-age" />
        <label>LocalizaÃ§Ã£o:</label><input type="text" id="edit-location" />
        <label>Interesses:</label><input type="text" id="edit-interests" />
        <button id="save-profile">Salvar</button>
        <button id="cancel-edit">Cancelar</button>
      </div>
    </div>

    <footer>
      <p>&copy; 2025 EmoConnect</p>
    </footer>

    <!-- Script duplicado removido -->
  </body>
</html>
